
{% extends 'base.html' %}
{% load static %}

{% block content %}
    <section id = "hero">
        
        <div class = "texts">
            <h4>Perfect your appearance with a Trendy Style.<br> Find your trendy style here</h4>
        <h1>new<br>Arrival</h1>
        <p>Save more with coupons & upto 70% Off</p>
        <a href="#" class="shop-now-button">Shop Now <span class="material-symbols-outlined" style="position: relative;
            top: 7px;
            right: -4px;">
            arrow_forward  </span></a>

        </div>
        

    </section>

    <section id = "features" class = "section-p1">
        <div class = "feature-box">
            <img src="{% static 'feature1.png' %}" alt="" height="60" width = "90">
            <h3>Free Shipping</h3>
           
        </div>
        <div class = "feature-box">
            <img src = "{% static 'onlineorder.png' %}" alt="" height="60" width = "90">
            <h3 style = "font-size: 16px;">Online Order</h3>
        </div>
        <div class = "feature-box">
            <img src = "{% static 'Promotions.png' %}" alt="" height="60" width = "90">
            <h3 style=" font-size: 18px">Promotions</h3>
           
        </div>
        <div class = "feature-box">
            <img src = "{% static 'savemoney.png' %}" alt="" height="60" width = "90">
            <h3>Save Money</h3>
           
        </div>
        <div class = "feature-box">
            <img src = "{% static 'support.png' %}" alt="" height="60" width = "110">
            <h3 style="font-size: 18px;">Support</h3>
           
        </div>
        <div class = "featuretext">
            <h2>Find all of your <br>favourite style</h2>
            <p>We got everything you need</p>
        </div>
        
    </section>

    <section id = "product1" class = "section-p1">
        
        <div class="pro-container">
            {% for product in products %}
            <div class="pro" style="text-decoration: none; color: inherit; position: relative;">
                <a href="{% url 'product_detail' product.slug %}" style="text-decoration: none; color: inherit;">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}">
                    <div class="des">
                        <span>{{ product.category }}</span>
                        <h5>{{ product.name }}</h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4>${{ product.price }}</h4>
                    </div>
                </a>
                <span class="material-symbols-outlined cart" style="color: black; cursor: pointer;" onclick="addToCart({{ product.id }}, event)">
                    add_shopping_cart
                </span>
            </div>
            {% endfor %}
        </div>


        <h2>We have many promo for everyday, don't miss out.<br>Check out now!</h2>
    </section>

    <section id= "banner" class="section-m1">
        <h4>Explore our Men's Collection</h4>
        <h2>Up to 70% off on All T-shirts and Pants</h2>
        <a href = "#" ><button class = "normal">Explore More</button></a>

    </section>
    
    <section id = "product1" class = "section-p1">
        
        <div class="pro-container">
            {% for product in products %}
            <div class="pro" style="text-decoration: none; color: inherit; position: relative;">
                <a href="{% url 'product_detail' product.slug %}" style="text-decoration: none; color: inherit;">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}">
                    <div class="des">
                        <span>{{ product.category }}</span>
                        <h5>{{ product.name }}</h5>
                        <div class="star">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                        </div>
                        <h4>${{ product.price }}</h4>
                    </div>
                </a>
                <span class="material-symbols-outlined cart" style="color: black; cursor: pointer;" onclick="addToCart({{ product.id }}, event)">
                    add_shopping_cart
                </span>
            </div>
            {% endfor %}
        </div>
    </section>
    
    <section id= "banner" class="section-m1" style="background-image: url({% static 'banner-3.jpeg' %}); height: 30vh;">
        <h2 id="dark-version">Explore the dark version of clothes</h2>

    </section>
    
    
    <section id= "smallbanner" >
        <div class = "banner-box" style = "background-image: url({% static 'sm-banner2.jpg' %});">
            <h4>Pure Black<br>for Men</h4>
            <a href = "#" ><button class = "banner-button">Explore More</button></a>
        </div>

        <div class = "banner-box" style = "background-image: url({% static 'sm-banner3.jpeg' %});">
            <h4>Pure Black<br>for Women</h4>
            <a href = "#" ><button class = "banner-button">Explore More</button></a>
        </div>

        <div class = "banner-box" style = "background-image: url({% static 'sm-banner5.jpg' %}); ">
            <h4 style="font-size: 60px">Headphones</h4>
            <a href = "#" ><button class = "banner-button">Explore More</button></a>
        </div>

        <div class = "banner-box box4" style = "background-image: url({% static 'smbanner-4.png' %}); ">
            <h4 style= "color: rgb(255, 255, 255);">Top Notch</h4>
            <h4 style= "color: black;">Sneakers</h4>
            <a href = "{% url 'sneakers' %}" ><button class = "banner-button" style="border: 1px solid #000000; box-shadow: 0 2px 6px rgb(0, 0, 0); color: black;">Explore More</button></a>
        </div>
        
    </section>

    <section id = "newsletter"  class = "section-p1">

        <div class = "newstext">
            <h4>Sign Up for Newsletter</h4>
            <p>Get E-mail updates about our latest shop and <span style="color: rgb(240, 240, 144);">special offers.</span></p>
        </div>

        <div class="form">
            <input type="text" placeholder="Enter your email">
            <button class = "banner-button">Sign Up</button>
        </div>

    </section>

<script>
function addToCart(productId, event) {
    event.preventDefault();
    event.stopPropagation();
    
    // Get CSRF token from meta tag
    const csrfToken = document.querySelector('meta[name="csrf-token"]')?.getAttribute('content');
    
    if (!csrfToken) {
        console.error('CSRF token not found');
        showNotification('Security error. Please refresh the page.', 'error');
        return;
    }
    
    fetch('{% url "add_to_cart" %}', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
            'X-CSRFToken': csrfToken
        },
        body: JSON.stringify({
            'product_id': productId,
            'quantity': 1
        })
    })
    .then(response => {
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
    })
    .then(data => {
        if (data.success) {
            showNotification(data.message, 'success');
            updateCartCount(data.cart_total);
        } else {
            showNotification(data.message, 'error');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showNotification('Error adding to cart. Please try again.', 'error');
    });
}

</script>
{% endblock %}